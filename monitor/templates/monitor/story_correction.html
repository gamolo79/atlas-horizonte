{% extends "monitor/dashboard/base.html" %}
{% block title %}Corrección de historia · Monitor{% endblock %}
{% block content %}
  <div class="page-header">
    <div>
      <h1 class="page-title">Corrección por historia</h1>
      <p class="muted">Ajusta el clustering y el título editorial.</p>
    </div>
    <div class="actions">
      <a class="secondary" href="{% url 'monitor_dashboard' %}">Dashboard</a>
    </div>
  </div>

  <section class="grid grid-2">
    <div class="card">
      <h3>Historia</h3>
      <h4>{{ story.title_base }}</h4>
      <p class="muted">{{ story.lead_base }}</p>
      <h4>Cluster de notas</h4>
      <ul>
      {% for story_article in articles %}
        <li>{{ story_article.article.title }}{% if story_article.is_representative %} (representativa){% endif %}</li>
      {% empty %}
        <li class="muted">Sin artículos</li>
      {% endfor %}
      </ul>
    </div>
    <div class="card">
      <h3>Corrección editorial</h3>
      <form method="post">
        {% csrf_token %}
        <p>
          <label>Campo</label>
          <input type="text" name="field_name" value="title_base" required>
        </p>
        <p>
          <label>Nuevo valor</label>
          <input type="text" name="new_value" required>
        </p>
        <p>
          <label>Explicación editorial</label>
          <textarea name="explanation" required></textarea>
        </p>
        <div class="actions">
          <button type="submit">Guardar corrección</button>
        </div>
      </form>
      <h4>Correcciones previas</h4>
      <ul>
      {% for correction in corrections %}
        <li>{{ correction.field_name }}: {{ correction.new_value }} ({{ correction.explanation }})</li>
      {% empty %}
        <li class="muted">Sin correcciones</li>
      {% endfor %}
      </ul>
    </div>
  </section>
{% endblock %}
