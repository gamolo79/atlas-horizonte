{% extends "monitor/dashboard/base.html" %}

{% block content %}
<div class="page-header">
    <div>
        <h1 class="page-title">Benchmark Explorer</h1>
        <p class="page-subtitle">Compara la cobertura mediática entre dos actores o instituciones.</p>
    </div>
</div>

<section class="card">
    <form method="get" action="">
        <div class="grid grid-3">
            <div>
                <h3 class="card-title">Entidad A</h3>
                <p class="card-desc">Selecciona el primer actor para comparar.</p>
                <label for="type_a">Tipo</label>
                <select id="type_a" name="type_a" onchange="toggleSelect('a')">
                    <option value="persona">Persona</option>
                    <option value="institucion">Institución</option>
                </select>

                <div id="container_persona_a" style="margin-top: 12px;">
                    <label>Persona</label>
                    <select name="id_a" id="select_persona_a">
                        {% for p in personas %}
                        <option value="{{ p.id }}">{{ p.nombre_completo }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div id="container_institucion_a" style="display:none; margin-top: 12px;">
                    <label>Institución</label>
                    <select name="id_a_inst" id="select_institucion_a" disabled>
                        {% for i in instituciones %}
                        <option value="{{ i.id }}">{{ i.nombre }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div style="display: flex; align-items: center; justify-content: center;">
                <div class="pill">VS</div>
            </div>

            <div>
                <h3 class="card-title">Entidad B</h3>
                <p class="card-desc">Selecciona el segundo actor para comparar.</p>
                <label for="type_b">Tipo</label>
                <select id="type_b" name="type_b" onchange="toggleSelect('b')">
                    <option value="persona">Persona</option>
                    <option value="institucion">Institución</option>
                </select>

                <div id="container_persona_b" style="margin-top: 12px;">
                    <label>Persona</label>
                    <select name="id_b" id="select_persona_b">
                        {% for p in personas %}
                        <option value="{{ p.id }}">{{ p.nombre_completo }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div id="container_institucion_b" style="display:none; margin-top: 12px;">
                    <label>Institución</label>
                    <select name="id_b_inst" id="select_institucion_b" disabled>
                        {% for i in instituciones %}
                        <option value="{{ i.id }}">{{ i.nombre }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>

        <div class="actions" style="justify-content: flex-end; margin-top: 18px;">
            <button type="submit">Comparar</button>
        </div>
    </form>
</section>

<script>
    function toggleSelect(side) {
        const type = document.getElementById('type_' + side).value;
        const pCont = document.getElementById('container_persona_' + side);
        const iCont = document.getElementById('container_institucion_' + side);
        const pSel = document.getElementById('select_persona_' + side);
        const iSel = document.getElementById('select_institucion_' + side);

        if (type === 'persona') {
            pCont.style.display = 'block';
            iCont.style.display = 'none';
            pSel.name = 'id_' + side;
            pSel.disabled = false;
            iSel.name = ''; // Unset name so it's not submitted
            iSel.disabled = true;
        } else {
            pCont.style.display = 'none';
            iCont.style.display = 'block';
            pSel.name = '';
            pSel.disabled = true;
            iSel.name = 'id_' + side;
            iSel.disabled = false;
        }
    }
</script>
{% endblock %}
