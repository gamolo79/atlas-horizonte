{% extends "monitor/dashboard/base.html" %}
{% block title %}Corrección de artículo · Monitor{% endblock %}
{% block content %}
  <div class="page-header">
    <div>
      <h1 class="page-title">Corrección por artículo</h1>
      <p class="muted">Editoría y ajustes sobre el análisis automatizado.</p>
    </div>
    <div class="actions">
      <a class="secondary" href="{% url 'monitor_ingest' %}">Volver a ingesta</a>
    </div>
  </div>

  <section class="grid grid-3">
    <div class="card">
      <h3>Nota original</h3>
      <h4>{{ article.title }}</h4>
      <p class="muted">{{ article.lead }}</p>
      <p>{{ article.body }}</p>
    </div>
    <div class="card">
      <h3>Resultado IA</h3>
      <h4>Actores</h4>
      <ul>
      {% for link in actor_links %}
        <li>{{ link.atlas_entity_type }} {{ link.atlas_entity_id }} · {{ link.sentiment }} ({{ link.sentiment_confidence }})</li>
      {% empty %}
        <li class="muted">Sin actores</li>
      {% endfor %}
      </ul>
      <h4>Temas</h4>
      <ul>
      {% for link in topic_links %}
        <li>{{ link.atlas_topic_id }} ({{ link.confidence }})</li>
      {% empty %}
        <li class="muted">Sin temas</li>
      {% endfor %}
      </ul>
    </div>
    <div class="card">
      <h3>Corrección</h3>
      <form method="post">
        {% csrf_token %}
        <p>
          <label>Campo</label>
          <input type="text" name="field_name" required>
        </p>
        <p>
          <label>Nuevo valor</label>
          <input type="text" name="new_value" required>
        </p>
        <p>
          <label>Explicación editorial</label>
          <textarea name="explanation" required></textarea>
        </p>
        <div class="actions">
          <button type="submit">Guardar corrección</button>
        </div>
      </form>
      <h4>Correcciones previas</h4>
      <ul>
      {% for correction in corrections %}
        <li>{{ correction.field_name }}: {{ correction.new_value }} ({{ correction.explanation }})</li>
      {% empty %}
        <li class="muted">Sin correcciones</li>
      {% endfor %}
      </ul>
    </div>
  </section>
{% endblock %}
